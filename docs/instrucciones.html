<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/caf9c96c/css/bootstrap.css" rel="stylesheet">
<link href="./assets/dbe19bdd/solarized_light.css" rel="stylesheet">
<link href="./assets/3baaa47c/style.css" rel="stylesheet">
<script src="./assets/3f3e3b9d/jquery.js"></script>
<script src="./assets/caf9c96c/js/bootstrap.js"></script>
<script src="./assets/756bff73/jssearch.js"></script>    <title>Guía de Gkri</title>
</head>
<body>

<div class="wrap">
    <nav id="w53" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w53-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">Guía de Gkri</a></div><div id="w53-collapse" class="collapse navbar-collapse"><ul id="w54" class="navbar-nav nav"><li><a href="api/index.html">Class reference</a></li>
<li><a href="./README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-44" data-toggle="collapse" data-parent="#navigation">&lt;a href=&quot;descripcion-general.md&quot;&gt;Descripción general del Proyecto&lt;/a&gt; <b class="caret"></b></a><div id="navigation-44" class="submenu panel-collapse collapse"><a class="list-group-item" href="./descripcion-general.html">Funcionalidad principal de la aplicación</a>
<a class="list-group-item" href="./descripcion-general.html">Objetivos Generales</a>
<a class="list-group-item" href="https://github.com/carlosgarcia8/gkri">Repositorio en GitHub</a>
<a class="list-group-item" href="https://carlosgarcia8.github.io/gkri/">Documentación</a></div>
<a class="list-group-item" href="#navigation-45" data-toggle="collapse" data-parent="#navigation">&lt;a href=&quot;instrucciones.md&quot;&gt;Instrucciones de instalación y despliegue&lt;/a&gt; <b class="caret"></b></a><div id="navigation-45" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-46" data-toggle="collapse" data-parent="#navigation">&lt;a href=&quot;requisitos.md&quot;&gt;Catálogo de Requisitos&lt;/a&gt; <b class="caret"></b></a><div id="navigation-46" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-47" data-toggle="collapse" data-parent="#navigation">&lt;a href=&quot;manual.md&quot;&gt;Manual básico de usuarios&lt;/a&gt; <b class="caret"></b></a><div id="navigation-47" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-48" data-toggle="collapse" data-parent="#navigation">&lt;a href=&quot;decisiones.md&quot;&gt;Decisiones adoptadas y su justificación&lt;/a&gt; <b class="caret"></b></a><div id="navigation-48" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-49" data-toggle="collapse" data-parent="#navigation">&lt;a href=&quot;dificultades.md&quot;&gt;Dificultades encontradas y soluciones aplicadas&lt;/a&gt; <b class="caret"></b></a><div id="navigation-49" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-50" data-toggle="collapse" data-parent="#navigation">Diagramas <b class="caret"></b></a><div id="navigation-50" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/carlosgarcia8/gkri/raw/master/guia/images/diagrama-clase.png">De clases</a>
<a class="list-group-item" href="https://github.com/carlosgarcia8/gkri/raw/master/guia/images/diagrama-logico.png">De estructura lógica de datos</a></div>
<a class="list-group-item" href="#navigation-51" data-toggle="collapse" data-parent="#navigation">&lt;a href=&quot;glosario.md&quot;&gt;Glosario de términos&lt;/a&gt; <b class="caret"></b></a><div id="navigation-51" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-52" data-toggle="collapse" data-parent="#navigation">&lt;a href=&quot;conclusiones.md&quot;&gt;Conclusiones&lt;/a&gt; <b class="caret"></b></a><div id="navigation-52" class="submenu panel-collapse collapse"></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Instrucciones de instalación y despliegue <span id="instrucciones-de-instalacion-y-despliegue"></span><a href="#instrucciones-de-instalacion-y-despliegue" class="hashlink">&para;</a></h1><h3>En local <span id="en-local"></span><a href="#en-local" class="hashlink">&para;</a></h3><h4>Requisitos <span id="requisitos"></span><a href="#requisitos" class="hashlink">&para;</a></h4><ul>
<li>php &gt;= 7.0.0</li>
<li>PostgreSQL &gt;= 9.5</li>
<li>composer</li>
<li>Cuenta en AWS S3</li>
<li>Cuenta en CloudConvert</li>
<li>Registrar una aplicación en Google+ API para poder iniciar sesión con la cuenta de google+</li>
<li>Correo electrónico</li>
<li>Tener apache2 (u otro servidor) bien configurado</li>
</ul>
<h4>Instalación <span id="instalacion"></span><a href="#instalacion" class="hashlink">&para;</a></h4><ol>
<li>Tener el apache2 (u otro servidor) configurado con un nombre de dominio creado (ej: gkri.local) y enlazado a <code>gkri/web/</code>.</li>
</ol>
<ol>
<li><p>Instalar el <em>composer</em>.</p>
</li>
<li><p>Seguir estos comandos.
<code>git clone https://github.com/carlosgarcia8/gkri.git
cd gkri
composer install
composer run-script post-create-project-cmd
cd web
chmod -R 777 uploads</code></p>
</li>
<li><p>Instalar el <em>PostgreSQL</em> y ejecutar los siguientes comandos desde la raiz del proyecto.
<code>cd db
./init.sh
./migraciones.sh
./create.sh</code>
Se habrá creado una base de datos llamada <code>gkri</code> con un usuario <code>gkri</code> y contraseña <code>gkri</code>.</p>
</li>
<li><p>Cambiar la distinta configuración:</p>
<ul>
<li>Admin.<ul>
<li>Cambiar el nombre de usuario de admins en <code>/config/web.php</code> para que concuerde con tu nombre de usuario.</li>
</ul>
</li>
<li>Cuenta de amazon s3.<ul>
<li>En <code>/config/web.php</code> cambiar el bucket y demas propiedades de la configuración que se tenga en AWS S3.</li>
<li>AWS_KEY: variable de entorno para la clave de AWS.</li>
<li>AWS_SECRET: variable de entorno para el secret de AWS.</li>
</ul>
</li>
<li>Cuenta de CloudConvert<ul>
<li>CC_KEY: variable de entorno para la clave de CloudConvert.</li>
</ul>
</li>
<li>Correo electrónico<ul>
<li>Cambiar el correo electrónico en <code>/config/web.php</code>.</li>
<li>SMTP_PASS: variable de entorno para la contraseña del correo electrónico.</li>
</ul>
</li>
<li>Google+ api<ul>
<li>GOOGLE_ID: variable de entorno para el id de la api google+.</li>
<li>GOOGLE_PASS: variable de entorno para la key de la api google+</li>
</ul>
</li>
</ul>
</li>
</ol>
<blockquote><p>Recuerda que esta configuración deberá de estar como variables de entorno para evitar que esten hard-codeadas (Solo la que se especifique como tal).</p>
</blockquote>
<h3>En la nube <span id="en-la-nube"></span><a href="#en-la-nube" class="hashlink">&para;</a></h3><h4>Despliegue en Heroku <span id="despliegue-en-heroku"></span><a href="#despliegue-en-heroku" class="hashlink">&para;</a></h4><ol>
<li>Tener cuenta en heroku y crear una aplicación. Instalar el comando heroku para trabajar por linea de comandos o bien hacerlo desde la página web.</li>
<li>Establecer las mismas variables de entorno que en local añadiendole una más (<code>YII_ENV=prod</code>).</li>
<li>Añadir el addon heroku-postgresql. Realizar un dump de la base de datos local o si se quiere se puede usar el dump.sql que viene en <code>db/</code>(conociendo que ya tiene un usuario creado).</li>
<li>Si se quiere añadir la funcionalidad de que cada 24 horas se borren los usuarios no confirmados, añadir el heroku-scheduler (se necesita añadir tarjeta de crédito a heroku) y decirle que ejecute el comando <code>./yii limpiar</code>.</li>
<li>Ejecutar los siguientes comandos:<pre><code class="hljs bash"><span class="hljs-built_in">cd</span> gkri
heroku login
heroku git:remote <span class="hljs-operator">-a</span> nombre_aplicacion_heroku
git push heroku master
</code></pre>
</li>
</ol>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Wed, 24 May 2017 13:46:41 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
